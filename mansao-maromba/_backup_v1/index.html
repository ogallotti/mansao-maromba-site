<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MANSÃO MAROMBA | Sabor Energético</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;600&family=Space+Mono:wght@400;700&family=Unbounded:wght@200;900&display=swap" rel="stylesheet">
    
    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>
    <script src="https://unpkg.com/@studio-freight/lenis@1.0.42/dist/lenis.min.js"></script>
</head>
<body>

    <!-- Preloader -->
    <div class="preloader">
        <div class="preloader-content">
            <div class="glitch-text" id="loader-text">CARREGANDO O SHAPE...</div>
            <div class="counter" id="loader-counter">0%</div>
        </div>
    </div>

    <!-- Navigation -->
    <nav style="position: fixed; top: 0; width: 100%; padding: 2rem; display: flex; justify-content: space-between; z-index: 100; mix-blend-mode: difference;">
        <div class="logo" style="font-family: 'Unbounded'; font-weight: 900; line-height: 1;">MANSÃO<br>MAROMBA</div>
        <div class="menu-btn" style="font-family: 'Space Mono'; border: 1px solid white; padding: 0.5rem 1rem;">MENU</div>
    </nav>

    <!-- Main Wrapper for Smooth Scroll -->
    <main>

        <!-- Hero Section -->
        <section class="hero" id="hero">
            <div class="hero-bg">
                <img src="assets/hero-bg.png" alt="Toguro Cyberpunk">
            </div>
            
            <div class="hero-content">
                <h1 class="hero-title back">MANSÃO</h1>
                
                <div class="hero-bottle-container">
                    <img src="assets/bottle.png" alt="Garrafa Mansão Maromba" class="bottle-hero">
                </div>
                
                <h1 class="hero-title front">MAROMBA</h1>
                
                <div class="scroll-indicator">
                    <span>ARRASTE PARA LANÇAR</span>
                </div>
            </div>
        </section>

        <!-- Transition Section -->
        <section class="transition-zone" id="transition">
            <h2 class="transition-title">SELECIONE SEU<br>COMBUSTÍVEL</h2>
        </section>
        
        <!-- Spacer to allow scrolling -->
        <div style="height: 50vh; background: #050505;"></div>

    </main>

    <script>
        // Initialize Lenis for smooth scrolling
        const lenis = new Lenis({
            duration: 1.2,
            easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
            direction: 'vertical',
            gestureDirection: 'vertical',
            smooth: true,
            mouseMultiplier: 1,
            smoothTouch: false,
            touchMultiplier: 2,
        });

        function raf(time) {
            lenis.raf(time);
            requestAnimationFrame(raf);
        }
        requestAnimationFrame(raf);

        // GSAP Registration
        gsap.registerPlugin(ScrollTrigger);

        // Preloader Logic
        const textStates = [
            "CARREGANDO O SHAPE...",
            "MISTURANDO OS INGREDIENTES...",
            "EM PLENO 2026...",
            "ANO DA TECNOLOGIA...",
            "FIDELIZA."
        ];
        
        let progress = 0;
        const counterEl = document.getElementById('loader-counter');
        const textEl = document.getElementById('loader-text');
        const preloader = document.querySelector('.preloader');

        const interval = setInterval(() => {
            progress += Math.floor(Math.random() * 5) + 1;
            if (progress > 100) progress = 100;
            
            counterEl.innerText = progress + '%';
            
            // Text logic
            if (progress < 25) textEl.innerText = textStates[0];
            else if (progress < 50) textEl.innerText = textStates[1];
            else if (progress < 75) textEl.innerText = textStates[2];
            else if (progress < 100) textEl.innerText = textStates[3];
            else textEl.innerText = textStates[4];

            if (progress === 100) {
                clearInterval(interval);
                finishPreloader();
            }
        }, 30);

        function finishPreloader() {
            gsap.to(preloader, {
                yPercent: -100,
                duration: 1,
                ease: "power4.inOut",
                delay: 0.5
            });
            
            initHeroAnimation();
        }

        // Hero Animation
        function initHeroAnimation() {
            const tl = gsap.timeline({
                scrollTrigger: {
                    trigger: ".hero",
                    start: "top top",
                    end: "+=2000", // Long scroll distance for the effect
                    scrub: 1,
                    pin: true,
                    anticipatePin: 1
                }
            });

            // 1. Initial State: Toguro holds the bottle (Static image has bottle, so we might need to hide the separate bottle initially or align it perfectly if we wanted to detach it). 
            // PROBLEM: The generated execution has Toguro holding a bottle in the invalid image. 
            // FIX: We will overlay our high-res bottle ON TOP of the image's bottle (if possible) or just start it slightly offset as if floating.
            // Since the generated image has a bottle, and we have a separate bottle asset, let's treat the separate asset as the "Flying Bottle".
            // We'll scale it up from the hand position.
            
            // Adjust bottle initial position (Assuming it starts roughly center where the hand is)
            // Ideally we'd position it with CSS but for now let's animate it 'out'.
            
            tl
            // Step 1: Text Separation (The Sandwich)
            .to(".hero-title.back", { xPercent: -50, opacity: 0, duration: 2 }, 0)
            .to(".hero-title.front", { xPercent: 50, opacity: 0, duration: 2 }, 0)
            
            // Step 2: Background Zoom (The "Launch")
            .to(".hero-bg img", { scale: 1.5, filter: "brightness(0.4)", duration: 5 }, 0)
            
            // Step 3: Bottle Flight
            .fromTo(".bottle-hero", 
                { scale: 0.8, y: 100, rotation: -15 },
                { scale: 1.2, y: 50, rotation: 15, duration: 4, ease: "power1.inOut" }, 0
            ) 
            // More complex flight path simulation
            .to(".bottle-hero", { 
                y: 500, // Move down towards next section
                scale: 0.5, 
                rotation: 0,
                duration: 4,
                ease: "power1.in"
            }, ">-1")
            
            // Fade out hero content to transition
            .to(".hero-content", { autoAlpha: 0, duration: 1 }, "-=1")
            
            // Transition Title Reveal
            .to(".transition-title", { opacity: 1, y: 0, duration: 1 }, "-=0.5");
        }
    </script>
</body>
</html>
